# Chap4
cjoonh  
June 24, 2015  

#R과 함께 하는 통계학의 이해


##Chap_4. 연속확률변수 및 분포

###4.1 연속확률변수의 확률분포함수

연속확률변수는 확률변수가 특정 구간의 모든 값을 다 가질 수 있기 때문에 가질 수 있는 값들을 일일이 지칭할 수 없는 확률변수를 의미함.

확률변수 X가 가질 수 있는 특정 구간에서 확률이 어떻게 분포하는가를 나타낼 수 있는 함수를 이용하게 된다. 즉, 연속확률변수 X의 확률분포는 확률의 밀도를 나타내는 확률밀도함수에 의해 결정된다.

▪ 확률밀도함수의 정의<br>
<img src="http://i.imgur.com/KFX7tUU.jpg">


▪ 확률밀도함수(a)와 아닌 경우(b)의 예<br>
<img src="https://i.imgur.com/WkKhn6t.jpg">
(a)의 경우에는 [-1,1]의 구간에 대해 f(x) = 0.5 > 0 인 직선이 표현되어 있다. 
<img src="https://i.imgur.com/Vt60HrZ.jpg">
나머지 구간에 대해서는 f(x)=0 이므로 
<img src="https://i.imgur.com/NQGTkmY.jpg">
즉 (a)에 표현된 -1≤x≤1에 대한 f(x)=0.5의 직선은 확률밀도함수이다.

(b)의 경우에는 [-1,1]의 구간에 대해 f(x) = -x 인 직선이 표현되어 있다. 
이 경우 해당 구간에 대해서는 
<img src=">https://i.imgur.com/oyScN1W.jpg">
나머지 구간에 대해서는 f(x)=0 이므로
<img src="https://i.imgur.com/UhqsU8P.jpg">
조건도 만족하게 된다.
그러나 0≤x≤1 의 구간에 대해서 f(x)≤0 이므로 -1≤x≤1에 대한 f(x)= -x의 직선은 
확률밀도함수가 아니다. 

연속확률변수 X가 특정한 값 x 를 갖게 될 확률은 0 이므로,
P(a≤X≤b)=P(a<X≤b)=P(a≤X<b)=P(a<X<b)

▪ 연속확률변수의 기대값과 분산<br>
<img src="https://i.imgur.com/wQU134P.jpg">
<img src="https://i.imgur.com/mKNJcBf.jpg">
이산확률변수의 경우 특정한 값 x를 가질 확률을 각각 구할 수 있기 때문에 각각의 값들을 다 더한 것.
연속확률변수의 경우에는 구간에 대한 확률로만 표현할 수 있기 때문에 적분의 계산 방법을 응용하는 것일 뿐 의미상의 차이는 없으므로 이산확률변수의 기대값과 분산의 성질은 연속확률변수에도 성립함.



###4.2 정규분포

**정규분포**  
통계학의 모든 분야에서 가장 중요하게 생각되는 대표적인 연속확률분포는 정규분포(normal
distribution)이다. 정규곡선이라 불리는 정규분포의 확률밀도함수는 [그림 4.2]의 그래프와
같이 좌우대칭의 종모양(bell-shape) 곡선으로, 이는 자연현상과 산업현장 등의 여러 연구 분
야에서 얻어지는 자료의 분포 형태를 묘사한다.
▪ 정규곡선<br>
종 모양의 확률밀도함수를 가지는 연속형확률변수  를 정규확률변수
(normal random variable)라 한다. 정규확률변수의 확률분포에 대한 수학적 방정식은 모집
단에 대한 평균 μ와 분산 σ^2에 의존한다. 정규분포에서 μ와 σ^2이 가지는 의미를 살펴보면, μ는 확률분포의 중심위치를 나타내고 σ^2은 정규곡선이 퍼져 있는 정도를 나타낸다.
<img src="https://i.imgur.com/ZeDQkWd.jpg">

▪ 정규곡선에서 평균과 분산의 의미<br>
<img src="https://i.imgur.com/W26OUEh.jpg">
붉은색의 정규곡선의 중심위치는 푸른색의 정규곡선보다 우측에 위치하고 있으며, 
붉은색의 정규곡선보다 푸른색의 정규곡선이 좁고 뾰족하게 나타난다.



###4.3 정규분포의 확률계산

μ와 σ^2에 따라 다양한 모양으로 나타나는 정규분포 중에서 평균이 0이고 분산이 1인 정규분포를 표준정규분포(standard normal distribution)라 한다. 일반적으로 표준정규분포를 따르는 확률변수는 Z로 표현하는데, Z ~ N(0,1)이므로 확률변수는 Z는 E(Z)= μ2 = 0을 중심으로 좌우대칭인 정규분포를 따르며, 분산은 Var(Z) = μ2^2 = 1와 같다.

정규분포의 유용한 특징 중 하나는 정규분포를 따르는 확률변수에 상수를 이용한 사칙연산을 하더라도 여전히 정규분포를 따르게 된다는 것이다. 이처럼 확률변수 X를 평균이 0이고 분산이 1인 확률변수 Z로 변환하는 과정을 표준화변환이라고 한다.

확률변수 X의 기대값을 μx, 분산을 σx^2 이라 하면, 확률변수 X에 대한 표준화변환의 방법은
<img src="https://i.imgur.com/LRV9HBN.jpg">
와 같으며, 표준화변수를 Z라 하면 Z의 기대값과 분산은 다음과 같다.
<img src="https://i.imgur.com/MSANb6C.jpg">
따라서 X∼N(μ,σ^2) 이라고 하면 표준화변수 Z는 평균이 0이고 분산이 1인 표준정규분포를 따르게 된다.

###보기4.1
**어떤 회사에서 제조되는 전구의 수명시간은 정규분포를 따른다고 한다. 제조되는 전구들에 대한 수명시간에 대한 평균은 3,000시간이고 표준편차는 80시간이라 할 때, 임의로 선택한 전구 1개의 수명시간이 2,948시간에서 3,080시간 사이일 확률을 구하여라.**
<img src="https://i.imgur.com/m5ycfTz.jpg">

R-프로그램의 내장함수 중 pnorm을 이용하면 정규분포에서의 확률을 쉽게 계산할 수 있다. 구문형식은
pnorom(x, mean = 0, sd = 1, lower.tail = TRUE)
이며, 여기서 x는 확률변수 X의 특정값을 의미한다. 그리고 mean은 평균(μ)을, sd는 표준편차(σ)를 의미하며, 이들 값을 입력하지 않으면 표준정규분포에서의 확률을 계산해준다. 그리고 lower.tail은 확률계산의 방향을 선택하는 옵션으로 그 값을 TRUE(또는 T)로 설정하면 P(X ≤ x)가 계산되고, FALSE(또는 F)로 하면 P(X ≥ x) 가 계산되며, 기본값은 TRUE이므로 TRUE(또는 T)로 설정 시에는 생략 가능하다.

pnorom(x, mean = 0, sd = 1, lower.tail = TRUE)

▪ 전구의 수명 시간에 대한 확률 계산법<br>
mu = 3000
sigma = 80
x1 = 2948
x2 = 3080
pnorm(x2,mean=mu,sd=sigma) - pnorm(x1,mean=mu,sd=sigma)
z1 = (x1-mu)/sigma
z2 = (x2-mu)/sigma
pnorm(z2) - pnorm(z1)

▪ 계산 결과<br>
0.5834986
0.5834986



###4.4 이항 분포의 정규근사

<img src="https://i.imgur.com/1ss2Zs7.jpg">
이항분포의 특징은 n이 증가함에 따라 분포의 형태가 점차 대칭에 가까워지고 종 모양을 이루게 된다.

p=0.4이고 n=5, 10, 20, 40인 경우에 대한 이항분포의 확률 히스토그램이다. 이 그림을 통해 n이 증가함에 따라 분포의 형태가 점차 좌우대칭의 종 모양에 가까워짐을 확인할 수 있다.
이와 같은 경향은 n이 커짐에 따라 더욱 확실하게 드러나게 되는데, 실제로 이항분포는 n이 증가함에 따라 근사적으로 정규분포를 따르게 된다. 이때, 정규분포의 평균과 분산은 이항분포에서와 일치하여야 하므로 다음과 같다.
<img src="https://i.imgur.com/Jmyh611.jpg">
일반적으로 np나 n(1 - p)가 모두 10 이상이면 이항분포 상에서의 확률과 근사정규분포 상에서의 확률적 차이가 아주 적다고 알려져 있다.
<img src="https://i.imgur.com/DY5Ha8i.jpg">

###보기 4.2
**확률변수 X가 n = 150, p = 0.6의 이항분포를 따른다고 하자. 이러한 확률변수 X가 82 이상 102 미만일 확률은 얼마인가?**

▪ 이항분포에서의 확률과 정규근사 확률 계산법<br>
pbinom 함수를 이용하여 이항분포에서 직접적으로 계산한 확률(0.8945357)과 pnorm 함수를 이용한 정규근사 확률(0.8940697)이 거의 비슷한 값을 가짐을 확인할 수 있다. (pbinom 함수의 이용방법은 3.6절 참조)

**이항분포에서 확률변수 X 가 82 에서 101 사이(102 미만이므로)에 값을 갖게 될 확률은 정규분포에서는 81.5 에서 101.5 사이에 값을 갖게될 확률로 구해야 한다. 정수 값을 연속적인 값으로 대응시켜서 확률을 구해야만 오차의 한계를 줄일 수 있기 때문이다. 이렇게 이항확률변수를 정규확률변수로 접근시킬 때 대응되는 값에 반올림을 고려해야 한다. 이것을 가리켜 연속성 수정 (continuity correction) 이라 한다)**

(이항분포에서의 확률)
n = 150
p = 0.6
pbinom(101,n,p) - pbinom(81,n,p)

(정규분포에서의 확률)
mu = n*p
sigma = sqrt(n*p*(1-p))
pnorm(101.5,mu,sigma) - pnorm(81.5,mu,sigma)

▪ 계산 결과<br>
0.8945357
0.8940697
